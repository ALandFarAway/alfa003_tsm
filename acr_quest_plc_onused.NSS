////////////////////////////////////////////////////////////////////////////////
//
//  System Name : ACR Configuration File
//     Filename : acf_plc_onused.nss
//    $Revision:: 183        $ current version of the file
//        $Date:: 2006-12-21#$ date the file was created or modified
//       Author : Ronan
//
//  Local Variable Prefix =
//
//  Dependencies external of nwscript:
//
//  Description
//  This script calls the ACR's OnUsed code for placeables, and any
//  custom code a server may need. It is not updated in ACR updates.
//
//  Revision History
//  Wynna 5/22/21 Created
////////////////////////////////////////////////////////////////////////////////

////////////////////////////////////////////////////////////////////////////////
// Includes ////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////

#include "acr_placeable_i"

////////////////////////////////////////////////////////////////////////////////
// Constants ///////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////

////////////////////////////////////////////////////////////////////////////////
// Structures //////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////

////////////////////////////////////////////////////////////////////////////////
// Global Variables ////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////

////////////////////////////////////////////////////////////////////////////////
// Function Prototypes /////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////

// The main event handler.
#include "acr_db_persist_i"

////////////////////////////////////////////////////////////////////////////////
// Function Definitions ////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////

void main() {
    ACR_PlaceableOnUsed();
  
	// Custom code goes here.
	object oPC = GetLastUsedBy();
	int nQuestState = GetLocalInt(OBJECT_SELF, "QuestStateToFire");
	string sQuest = GetLocalString(OBJECT_SELF, "Quest");
	SendMessageToPC(oPC, sQuest + " = " + IntToString(ACR_GetPersistentInt(oPC, sQuest)));
	
	
	string sSuccess = GetLocalString(OBJECT_SELF, "QuestMessageSuccess");
	string sFail = GetLocalString(OBJECT_SELF, "QuestMessageFail");
	
	if(ACR_GetPersistentInt(oPC, sQuest) == nQuestState) {
		ACR_SetPersistentInt(oPC, sQuest, nQuestState+1);
		SendMessageToPC(oPC, sSuccess);
	}
	
	else {SendMessageToPC(oPC, sFail);}
	
 
	
}