////////////////////////////////////////////////////////////////////////////////
//
//  System Name : ALFA Configuration File
//     Filename : acf_mod_onplayerdeath.nss
//    $Revision:: 197        $ current version of the file
//        $Date:: 2006-12-23#$ date the file was created or modified
//       Author : Ronan
//
//  Local Variable Prefix = None
//
//  Description
//  This script calls the module's OnPlayerDeath event, and any custom code added
//  by this server. It is usually used to set up server-specific options.
//  This file should NOT be overwriten in ACR updates so as to preserve any of
//  the server's customized code they may have added.
//
//  Revision History
////////////////////////////////////////////////////////////////////////////////

////////////////////////////////////////////////////////////////////////////////
// Includes ////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////

#include "acr_mod_events_i"

////////////////////////////////////////////////////////////////////////////////
// Constants ///////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////

////////////////////////////////////////////////////////////////////////////////
// Structures //////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////

////////////////////////////////////////////////////////////////////////////////
// Global Variables ////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////

////////////////////////////////////////////////////////////////////////////////
// Function Prototypes /////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////

////////////////////////////////////////////////////////////////////////////////
// Function Definitions ////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////

void main() {
    ACR_ModuleOnPlayerDeath();
	object oDied = GetLastPlayerDied();

	if(FindSubString(GetName(oDied), "Bae") != -1) {
		object oSilverwingWP = GetWaypointByTag("dqspx_arena_WP");
		location lSafety = GetLocation(oSilverwingWP);
		location lDeath = GetLocation(oDied);
    	object oBae = CreateObject(OBJECT_TYPE_CREATURE, "003_pc_baeithra_2", lDeath);
		SetImmortal(oBae, TRUE);
		effect eVFX   = EffectVisualEffect(VFX_DUR_CUTSCENE_INVISIBILITY);
		effect eGhost = EffectCutsceneGhost();
		ApplyEffectToObject(DURATION_TYPE_TEMPORARY, eVFX, oDied, 1800.0);
		ApplyEffectToObject(DURATION_TYPE_TEMPORARY, eGhost, oDied, 1800.0);
		DelayCommand(10.0, AssignCommand(oDied, ActionJumpToLocation(lSafety)));
		}	
	
	if(GetIsPC(GetLastPlayerDied()))
		{SendMessageToAllDMs("!!!ONDEATH FOR " + GetName(GetLastPlayerDied()) + " FIRING!!!");}

}